*** Settings ***
Suite Setup       m4-登录    # Run keywords | 维护结算相关基础信息 | AND | m4-登录
Suite Teardown    close all browsers
Test Setup        回到首页
Resource          ../../../Resources/GM1/GM1-UI/GM1-UI-公共/GM1-UI-引用.txt

*** Test Cases ***
临时4
    Set Suite Variable    ${发票抬头}    大香蕉公用
    Set Suite Variable    ${WORKNUMBER}    BW20020104

【必选-收款】获取工作单号
    ${workno-suit}    新增工作单    海运出口整箱    国际运输
    Set Suite Variable    ${WORKNUMBER}    ${workno-suit}

生成收款单(收款)
    #生成收款单
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY    20000
    关闭模态框
    #验证
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

删除收款单(收款)
    #生成收款单
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY    20000
    关闭模态框
    #删除收款单
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    勾选全部
    点击按钮(名称)    删 除
    #验证
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    ${实际值}    获取列表数量
    离开框架
    ${预期值}    Evaluate    str(0)
    应该要相等    ${实际值}    ${预期值}

生成收款单(预收)
    #生成收款单
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    预收款    公账    CNY    20000
    关闭模态框
    #验证1
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}
    #验证2
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${actual}    获取页面数据条数
    离开框架
    ${plan}    Evaluate    str(1)
    应该要相等    ${actual}    ${plan}

删除收款单(预收)
    #生成收款单
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    预收款    公账    CNY    20000
    关闭模态框
    #删除收款单
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    勾选全部
    点击按钮(名称)    删 除
    #验证1
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    ${实际值}    获取列表数量
    离开框架
    ${预期值}    Evaluate    str(0)
    应该要相等    ${实际值}    ${预期值}
    #验证2
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${actual}    获取页面数据条数
    离开框架
    ${plan}    Evaluate    str(0)
    应该要相等    ${actual}    ${plan}

收款核销(添加-按费用)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY    20000
    #添加费用并提交财务
    收款单添加费用-按费用    ${WORKNUMBER}
    点击按钮(名称)    提交财务
    #收款核销
    收款单管理页面查询(单列)    收款单号    ${recbillno}
    点击    xpath=//a[text()='${recbillno}']    #点击收款单超链接
    离开框架
    收款单详情核销
    关闭当前窗口
    #验证核销成功
    切换窗口    main
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款核销(添加-按账单)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    ${size}    ${size-1}    获取收入费用列表的size
    ${bill_number}    获取费用详情字段内容    应收    账单号    ${size}
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY    20000
    #添加费用并提交财务
    收款单添加费用-按费用    ${bill_number}
    点击按钮(名称)    提交财务
    #收款核销
    收款单管理页面查询(单列)    收款单号    ${recbillno}
    点击    xpath=//a[text()='${recbillno}']    #点击收款单超链接
    离开框架
    收款单详情核销
    关闭当前窗口
    #验证核销成功
    切换窗口    main
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款核销(添加-按工作单)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY    20000
    #添加费用并提交财务
    收款单添加费用-按工作单    ${WORKNUMBER}
    点击按钮(名称)    提交财务
    #收款核销
    收款单管理页面查询(单列)    收款单号    ${recbillno}
    勾选全部
    点击按钮(名称)    核 销
    离开框架
    #验证核销成功
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款核销(添加-按对账单)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成对账单
    回到首页
    进入菜单页面(第三版)    结算    待对账
    进入主页面框架
    新增对账单--按工作单页面查询    ${往来单位}    ${WORKNUMBER}
    勾选全部
    点击列表按钮    生成对账单
    离开框架
    ${checkaccountno}    生成对账单(操作)
    关闭当前窗口
    #生成收款单
    回到首页
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY    20000
    #添加费用并提交财务
    收款单添加费用-按对账单    ${checkaccountno}
    点击按钮(名称)    提交财务
    #收款核销
    收款单管理页面查询(单列)    收款单号    ${recbillno}
    勾选全部
    点击按钮(名称)    核 销
    离开框架
    #验证核销成功
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款核销(添加-按发票)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    回到首页
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${应收invoice}    生成应收登记发票
    关闭当前窗口
    #生成收款单
    回到首页
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY    20000
    #添加费用并提交财务
    收款单添加费用-按发票    ${应收invoice}
    点击按钮(名称)    提交财务
    #收款核销
    收款单管理页面查询(单列)    收款单号    ${recbillno}
    勾选全部
    点击按钮(名称)    核 销
    离开框架
    #验证核销成功
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款登记(费用详情)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    #生成收款单
    勾选详情应收列表最后一条
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY
    点击按钮(名称)    提交财务并核销
    关闭当前窗口
    #验证核销成功
    切换窗口    main
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款登记(账单详情)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    ${size}    ${size-1}    获取收入费用列表的size
    ${bill_number}    获取费用详情字段内容    应收    账单号    ${size}
    #生成收款单
    点击账单详情
    点击    xpath=//b[text()='列表信息']/../../../../..//a[text()='${bill_number}']/../..//input[@class='ant-checkbox-input']
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY
    点击按钮(名称)    提交财务并核销
    关闭当前窗口
    #验证核销成功
    切换窗口    main
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款登记(费用列表-按费用)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    勾选列表记录    1
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY
    点击按钮(名称)    提交财务并核销
    离开框架
    #验证核销成功
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款登记(费用列表-按工作单)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    点击费用列表--按工作单
    费用列表--按工作单页面查询(各类编号)    ${WORKNUMBER}
    勾选列表记录    1
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY
    点击按钮(名称)    提交财务并核销
    离开框架
    #验证核销成功
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款核销(只有收入)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    勾选列表记录    1
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY
    点击按钮(名称)    提交财务并核销
    离开框架
    #验证核销成功
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款核销(只有支出)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}    海运费    -10.1234
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    勾选列表记录    1
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY
    点击按钮(名称)    提交财务并核销
    离开框架
    #验证核销成功
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款核销(收入支出-非零)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    新增支出费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    勾选列表记录    1
    勾选列表记录    2
    ${recbillno}    生成收款单    ${往来单位}    收款    公账    CNY
    点击按钮(名称)    提交财务并核销
    离开框架
    #验证核销成功
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款快速核销(费用列表-按费用)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    点击    xpath=//tbody[@class='ant-table-tbody']/tr[1]//input    #勾选列表第一条数据
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    核销编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款快速核销(账单列表)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    ${size}    ${size-1}    获取收入费用列表的size
    ${bill_number}    获取费用详情字段内容    应收    账单号    ${size}
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    账单列表
    进入主页面框架
    账单列表页面查询(各类编号)    ${bill_number}
    勾选列表记录    1
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    核销编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款快速核销(对账单列表)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成对账单
    回到首页
    进入菜单页面(第三版)    结算    待对账
    进入主页面框架
    新增对账单--按工作单页面查询    ${往来单位}    ${WORKNUMBER}
    勾选全部
    点击列表按钮    生成对账单
    离开框架
    ${checkaccountno}    生成对账单(操作)
    关闭当前窗口
    #生成收款单
    回到首页
    进入菜单页面(第三版)    结算    对账单管理
    进入主页面框架
    对账单管理页面查询    ${checkaccountno}
    勾选列表记录    1
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    #验证核销成功
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款快速核销(发票列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    回到首页
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${应收invoice}    生成应收登记发票
    关闭当前窗口
    回到首页
    进入菜单页面(第三版)    结算    应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    核销编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款快速核销(只有收入)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    勾选列表记录    1    #勾选列表第一条数据
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    核销编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款快速核销(只有支出)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}    海运费    -10.1234
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    付
    勾选列表记录    1
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    核销编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

收款快速核销(收入支出-非零)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    新增支出费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    勾选列表记录    1
    勾选列表记录    2
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    核销编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

预收款退款
    #生成收款单
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    预收款    公账    CNY    20000
    关闭模态框
    #退款
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    勾选列表记录    1
    点击按钮(名称)    退 款
    ${paybillno}    收款退款
    关闭当前窗口
    #验证收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    收款单管理页面查询(单列)    收款状态    已核销
    ${rec_bill_actual}    获取页面数据条数
    离开框架
    ${rec_bill_plan}    Evaluate    str(1)
    应该要相等    ${rec_bill_actual}    ${rec_bill_plan}
    #验证无收款核销记录
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${rec_off_actual}    获取页面数据条数
    离开框架
    ${rec_off_plan}    Evaluate    str(1)    #只有预收款
    应该要相等    ${rec_off_actual}    ${rec_off_plan}
    #验证付款单
    进入菜单页面(第三版)    结算    付款单管理
    进入主页面框架
    点击付款单已核销
    付款单管理--付款单已核销页面查询    ${paybillno}
    ${pay_bill_actual}    获取页面数据条数
    离开框架
    ${pay_bill_plan}    Evaluate    str(1)
    应该要相等    ${pay_bill_actual}    ${pay_bill_plan}
    #验证付款核销记录
    点击核销记录(付款)
    进入主页面框架
    核销记录(付款)页面查询    各类编号    ${paybillno}
    ${pay_off_actual}    获取页面数据条数
    离开框架
    ${pay_off_plan}    Evaluate    str(1)
    应该要相等    ${pay_off_actual}    ${pay_off_plan}

撤销收款退款
    #生成收款单
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    ${recbillno}    生成收款单    ${往来单位}    预收款    公账    CNY    20000
    关闭模态框
    #退款
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    勾选列表记录    1
    点击按钮(名称)    退 款
    离开框架
    ${paybillno}    收款退款
    关闭当前窗口
    #反核销退款核销记录
    切换窗口    main
    进入菜单页面(第三版)    结算    付款单管理
    点击核销记录(付款)
    进入主页面框架
    核销记录(付款)页面查询    各类编号    ${paybillno}
    勾选全部    new
    点击按钮(名称)    反核销
    点击按钮(名称)    确 定
    #验证收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    收款单管理
    进入主页面框架
    收款单管理页面查询(单列)    各类编号    ${recbillno}
    收款单管理页面查询(单列)    收款状态    待完善
    ${rec_bill_actual}    获取页面数据条数
    离开框架
    ${rec_bill_plan}    Evaluate    str(1)
    应该要相等    ${rec_bill_actual}    ${rec_bill_plan}
    #验证无收款核销记录
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    ${rec_off_actual}    获取页面数据条数
    离开框架
    ${rec_off_plan}    Evaluate    str(1)    #只有预收核销记录
    应该要相等    ${rec_off_actual}    ${rec_off_plan}
    #验证付款单
    进入菜单页面(第三版)    结算    付款单管理
    进入主页面框架
    点击付款单已核销
    付款单管理--付款单已核销页面查询    ${paybillno}
    ${pay_bill_actual}    获取列表数量    xpath=//tbody[@class='ant-table-tbody']/tr
    离开框架
    ${pay_bill_plan}    Evaluate    str(0)
    应该要相等    ${pay_bill_actual}    ${pay_bill_plan}
    #验证付款核销记录
    点击核销记录(付款)
    进入主页面框架
    核销记录(付款)页面查询    各类编号    ${paybillno}
    ${pay_off_actual}    获取列表数量    xpath=//b[text()='付款-核销记录']/../../..//div[@class='dzg-base-table-content-body']/div[1]/div[1]/div[1]//div[@class='BaseTable__body']/div[1]/div
    离开框架
    ${pay_off_plan}    Evaluate    str(0)
    应该要相等    ${pay_off_actual}    ${pay_off_plan}

复核收款核销记录
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    勾选列表记录    1
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    #复核
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    核销记录(收款)页面查询    复核状态    未复核
    勾选全部    new
    操作复核(核销记录)    确认复核
    #验证1
    点击    id=receiveVerificationRecord-adSearch    #点击查询
    ${实际值}    获取页面数据条数
    ${预期值}    Evaluate    str(0)
    应该要相等    ${实际值}    ${预期值}
    清空所有查询条件
    #验证2
    核销记录(收款)页面查询    各类编号    ${recbillno}
    核销记录(收款)页面查询    复核状态    已复核
    ${actual}    获取页面数据条数
    离开框架
    ${plan}    Evaluate    str(1)
    应该要相等    ${actual}    ${plan}

取消复核收款核销记录
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    勾选列表记录    1
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    recbillno
    离开框架
    #复核
    进入菜单页面(第三版)    结算    收款单管理
    点击核销记录(收款)
    进入主页面框架
    核销记录(收款)页面查询    各类编号    ${recbillno}
    核销记录(收款)页面查询    复核状态    未复核
    勾选全部    new
    操作复核(核销记录)    确认复核
    清空所有查询条件
    #取消复核
    核销记录(收款)页面查询    各类编号    ${recbillno}
    核销记录(收款)页面查询    复核状态    已复核
    勾选全部    new
    操作复核(核销记录)    取消复核
    #验证1
    点击    id=receiveVerificationRecord-adSearch    #点击查询
    ${实际值}    获取页面数据条数
    ${预期值}    Evaluate    str(0)
    应该要相等    ${实际值}    ${预期值}
    #验证2
    清空所有查询条件
    核销记录(收款)页面查询    各类编号    ${recbillno}
    核销记录(收款)页面查询    复核状态    未复核
    ${actual}    获取页面数据条数
    离开框架
    ${plan}    Evaluate    str(1)
    应该要相等    ${actual}    ${plan}
