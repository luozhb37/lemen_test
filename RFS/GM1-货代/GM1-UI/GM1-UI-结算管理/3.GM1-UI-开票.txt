*** Settings ***
Suite Setup       m4-登录
Suite Teardown    close all browsers
Test Setup        回到首页
Resource          ../../../Resources/GM1/GM1-UI/GM1-UI-公共/GM1-UI-引用.txt

*** Test Cases ***
临时3
    Set Suite Variable    ${发票抬头}    大香蕉公用
    Set Suite Variable    ${WORKNUMBER}    B--2020030022
    #维护费用

【必选-开票】获取工作单号
    ${workno-suit}    新增工作单    海运出口整箱    国际运输
    Set Suite Variable    ${WORKNUMBER}    ${workno-suit}

开票通知(费用详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知(账单详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    ${size}    ${size-1}    获取收入费用列表的size
    ${bill_number}    获取费用详情字段内容    应收    账单号    ${size}
    #生成开票通知
    点击账单详情
    勾选账单详情指定数据进入财务流程    ${bill_number}    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知(费用列表-按费用)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成开票通知
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    勾选列表记录    1
    点击开票通知(申请/不开票)    开票申请
    离开框架
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知(费用列表-按工作单)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成开票通知
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    点击费用列表--按工作单
    费用列表--按工作单页面查询(各类编号)    ${WORKNUMBER}
    勾选全部
    点击开票通知(申请/不开票)    开票申请
    离开框架
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知(账单列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    ${size}    ${size-1}    获取收入费用列表的size
    ${bill_number}    获取费用详情字段内容    应收    账单号    ${size}
    关闭当前窗口
    #生成开票通知
    切换窗口    main
    进入菜单页面(第三版)    结算    账单列表
    账单列表页面查询(各类编号)    ${bill_number}
    勾选列表记录    1
    点击开票通知(申请/不开票)    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知(按对账单)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增收入费用    ${往来单位}    ${发票抬头}
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成对账单
    切换窗口    main
    进入菜单页面(第三版)    结算    待对账
    进入主页面框架
    新增对账单--按工作单页面查询    ${往来单位}    ${WORKNUMBER}
    勾选全部
    点击列表按钮    生成对账单
    离开框架
    ${checkaccountno}    生成对账单(操作)
    关闭当前窗口
    #生成开票通知
    回到首页
    进入菜单页面(第三版)    结算    对账单管理
    进入主页面框架
    对账单管理页面查询    ${checkaccountno}
    勾选全部
    点击列表按钮    开票通知
    离开框架
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知-增值税普通发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知    增值税普通发票
    关闭当前窗口
    #检查开票通知是否生成
    回到首页
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知-增值税专用发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知    增值税专用发票
    关闭当前窗口
    #检查开票通知是否生成
    回到首页
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知-增值税普通电子发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知    增值税普通电子发票
    关闭当前窗口
    #检查开票通知是否生成
    回到首页
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知-形式发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知    形式发票
    关闭当前窗口
    #检查开票通知是否生成
    回到首页
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--其他
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

开票通知-不开发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知    不开发票
    关闭当前窗口
    #检查开票通知是否生成
    回到首页
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${preInvoiceno}
    ${result}    获取页面数据条数
    离开框架
    应该要相等（数字）    ${result}    1

不开票(费用详情)
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${before_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    不开票
    等待loading消失
    关闭当前窗口
    切换窗口    main
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${after_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #校验
    ${handle_num}    Evaluate    ${before_num}+1
    应该要相等（数字）    ${handle_num}    ${after_num}

不开票(账单详情)
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${before_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    ${size}    ${size-1}    获取收入费用列表的size
    ${bill_number}    获取费用详情字段内容    应收    账单号    ${size}
    #生成开票通知
    点击账单详情
    勾选账单详情指定数据进入财务流程    ${bill_number}    不开票
    等待loading消失
    关闭当前窗口
    切换窗口    main
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${after_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #校验
    ${handle_num}    Evaluate    ${before_num}+1
    应该要相等（数字）    ${handle_num}    ${after_num}

不开票(费用列表-按费用)
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${before_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成不开票
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    收
    勾选列表记录    1
    点击开票通知(申请/不开票)    不开票
    离开框架
    等待loading消失
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${after_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #校验
    ${handle_num}    Evaluate    ${before_num}+1
    应该要相等（数字）    ${handle_num}    ${after_num}

不开票(费用列表-按工作单)
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${before_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成不开票
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    点击费用列表--按工作单
    费用列表--按工作单页面查询(各类编号)    ${WORKNUMBER}
    勾选全部
    点击开票通知(申请/不开票)    不开票
    离开框架
    等待loading消失
    #查看不开票数量
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    点击应收未开票--不开票
    应收待开票页面查询    ${WORKNUMBER}
    ${after_num}    获取列表数量    xpath=//li[@class='ant-pagination-total-text']
    离开框架
    #校验
    ${handle_num}    Evaluate    ${before_num}+1
    应该要相等（数字）    ${handle_num}    ${after_num}

汇总开票(待开票)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选列表记录    1
    点击列表按钮    汇总开票
    离开框架
    切换窗口    new
    ${invoice}    进入详情生成发票
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

明细开票(待开票)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选列表记录    1
    点击列表按钮    明细开票
    离开框架
    切换窗口    new
    ${invoice}    进入详情生成发票
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应收登记发票(待开票)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选列表记录    1
    点击列表按钮    登记发票号
    ${应收invoice}    生成应收登记发票
    离开框架
    #关闭弹出窗口
    切换窗口    new
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

汇总开票(自定义开票)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    汇总开票
    切换窗口    new
    ${应收invoice}    进入详情生成发票
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

明细开票(自定义开票)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    等待loading消失
    勾选全部
    点击列表按钮    明细开票
    离开框架
    切换窗口    new
    ${invoice}    进入详情生成发票
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应收登记发票(自定义开票)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    Comment    关闭当前窗口    #关闭费用详情
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${应收invoice}    生成应收登记发票
    #关闭弹出窗口
    切换窗口    new
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

汇总开票(开票通知详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    点击代发票号进入详情页    ${preInvoiceno}
    离开框架
    切换窗口    new
    等待loading消失
    点击按钮(名称)    汇总开票
    等待loading消失
    切换窗口    new
    ${应收invoice}    进入详情生成发票
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

明细开票(开票通知详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    点击代发票号进入详情页    ${preInvoiceno}
    离开框架
    切换窗口    new
    等待loading消失
    点击按钮(名称)    明细开票
    等待loading消失
    切换窗口    new
    ${invoice}    进入详情生成发票
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应收登记发票(开票通知详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    关闭当前窗口
    #生成发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    点击代发票号进入详情页    ${preInvoiceno}
    离开框架
    切换窗口    new
    等待loading消失
    点击按钮(名称)    登记发票号
    等待loading消失
    ${应收invoice}    生成应收登记发票
    #关闭弹出窗口
    切换窗口    new
    关闭当前窗口
    #查询发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

作废应收发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选列表记录    1
    点击列表按钮    登记发票号
    ${应收invoice}    生成应收登记发票
    离开框架
    #关闭弹出窗口
    切换窗口    new
    关闭当前窗口
    #作废发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    作废应收发票
    点击按钮(名称)    已作废
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

冲红应收发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选列表记录    1
    点击列表按钮    登记发票号
    ${应收invoice}    生成应收登记发票
    离开框架
    #关闭弹出窗口
    切换窗口    new
    关闭当前窗口
    #作废发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    冲红应收发票
    点击按钮(名称)    已冲红
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(2)
    应该要相等    ${实际值}    ${预期值}

修改应收发票
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    #生成开票通知
    费用详情点击开票通知    开票申请
    ${preInvoiceno}    生成开票通知    增值税专用发票
    #检查开票通知是否生成
    切换窗口    main
    进入菜单页面(第三版)    结算    应收未开票
    进入主页面框架
    应收待开票页面查询    ${preInvoiceno}
    勾选列表记录    1
    点击列表按钮    登记发票号
    ${应收invoice}    生成应收登记发票
    离开框架
    #关闭弹出窗口
    切换窗口    new
    关闭当前窗口
    #作废发票
    切换窗口    main
    点击应收发票管理
    进入主页面框架
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    修改应收发票
    应收发票管理页面查询(单列)    各类编号    ${应收invoice}
    勾选全部    new    #勾选全部
    ${实际值}    获取页面文本内容    xpath=//span[@class='dzg-base-table-sum-row-number']
    离开框架
    #检查
    ${预期值}    Evaluate    str(2)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(费用详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    #登记应付发票
    勾选详情应付列表最后一条
    点击指定列表按钮    应付    发票登记
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(账单详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #登记应付发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付待登记
    进入主页面框架
    登记发票--按工作单页面查询    ${WORKNUMBER}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(应付待登记-按工作单)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #登记应付发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付待登记
    进入主页面框架
    登记发票--按工作单页面查询    ${WORKNUMBER}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(费用列表-按费用)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #登记应付发票
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    勾选列表记录    1
    点击列表按钮    登记应付发票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(费用列表-按工作单)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #登记应付发票
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    点击费用列表--按工作单
    费用列表--按工作单页面查询(各类编号)    ${WORKNUMBER}
    勾选全部
    点击列表按钮    登记应付发票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(账单列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    ${size}    ${size-1}    获取收入费用列表的size
    ${bill_number}    获取费用详情字段内容    应收    账单号    ${size}
    关闭当前窗口
    #登记应付发票
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    勾选列表记录    1
    点击列表按钮    登记应付发票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(对账单列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成对账单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    勾选列表记录    1
    点击列表按钮    对账单
    离开框架
    等待loading消失
    切换窗口    new
    ${checkaccountno}    获取页面文本内容    xpath=//label[@title='对账单号']/../..//div[@class='ant-form-item-control ']/span
    关闭当前窗口
    #按对账单登记应付发票
    切换窗口    main
    进入菜单页面(第三版)    结算    对账单管理
    进入主页面框架
    对账单管理页面查询    ${checkaccountno}
    勾选全部
    点击列表按钮    登记应付发票
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    离开框架
    #查询发票
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(按请款单详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    #生成请款单
    勾选详情应付列表最后一条
    点击指定列表按钮    应付    请 款
    ${applyNo}    生成请款单
    #登记应付发票号
    点击按钮(名称)    登记应付发票
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

应付发票登记(按请款单列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    #生成请款单
    勾选详情应付列表最后一条
    点击指定列表按钮    应付    请 款
    ${applyNo}    生成请款单
    关闭当前窗口
    #登记应付发票号
    切换窗口    main
    进入菜单页面(第三版)    结算    请款单管理
    进入主页面框架
    请款单管理--不可受理页面查询    ${applyNo}
    勾选列表记录    1
    点击按钮(名称)    登记应付发票号
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}
