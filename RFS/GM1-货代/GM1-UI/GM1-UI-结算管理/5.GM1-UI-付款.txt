*** Settings ***
Suite Setup       m4-登录
Suite Teardown    close all browsers
Test Setup        回到首页
Resource          ../../../Resources/GM1/GM1-UI/GM1-UI-公共/GM1-UI-引用.txt

*** Test Cases ***
临时5
    Set Suite Variable    ${发票抬头}    大香蕉公用
    Set Suite Variable    ${WORKNUMBER}    B--2020030079

【必选-付款】获取工作单号
    ${workno-suit}    新增工作单    海运出口整箱    国际运输
    Set Suite Variable    ${WORKNUMBER}    ${workno-suit}

生成请款单(费用详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    基石列表查询【第二版】    输入选择;各类编号;${WORKNUMBER}
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    #生成请款单
    勾选详情应付列表最后一条
    点击指定列表按钮    应付    请 款
    ${applyNo}    生成请款单
    关闭当前窗口
    #检查请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    我的请款单
    进入主页面框架
    我的请款单--未付款页面查询    ${applyNo}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

生成请款单(账单详情)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    基石列表查询【第二版】    输入选择;各类编号;${WORKNUMBER}
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    ${size}    ${size-1}    获取支出费用列表的size
    ${bill_number}    获取费用详情字段内容    应付    账单号    ${size}
    #生成请款单
    点击账单详情
    勾选账单详情指定数据进入财务流程    ${bill_number}    请款
    ${applyNo}    生成请款单
    关闭当前窗口
    #检查请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    我的请款单
    我的请款单--未付款页面查询    ${applyNo}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

生成请款单(费用列表-按费用)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    基石列表查询【第二版】    输入选择;各类编号;${WORKNUMBER}
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    基石列表查询【第二版】    输入选择;工作单号;${WORKNUMBER}|输入选择;类型;付
    勾选列表数据(new)    1
    点击按钮(名称)    请 款
    离开框架
    ${applyNo}    生成请款单
    关闭当前窗口
    #检查请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    我的请款单
    进入主页面框架
    我的请款单--未付款页面查询    ${applyNo}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

生成请款单(费用列表-按工作单)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    基石列表查询【第二版】    输入选择;各类编号;${WORKNUMBER}
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    点击费用列表--按工作单
    基石列表查询【第二版】    输入选择;工作号;${WORKNUMBER}|输入选择;类型;付
    勾选列表数据(new)    1
    ${applyNo}    生成请款单
    关闭当前窗口
    #检查请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    我的请款单
    进入主页面框架
    我的请款单--未付款页面查询    ${applyNo}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

生成请款单(账单列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    基石列表查询【第二版】    输入选择;各类编号;${WORKNUMBER}
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    ${size}    ${size-1}    获取支出费用列表的size
    ${bill_number}    获取费用详情字段内容    应付    账单号    ${size}
    #生成请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    账单列表页面查询(各类编号)    ${bill_number}
    点击按钮(名称)    请 款
    离开框架
    ${applyNo}    生成请款单
    关闭当前窗口
    #检查请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    我的请款单
    进入主页面框架
    我的请款单--未付款页面查询    ${applyNo}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

生成请款单(对账单列表)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    基石列表查询【第二版】    输入选择;各类编号;${WORKNUMBER}
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #生成对账单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    基石列表查询【第二版】    输入选择;工作单号;${WORKNUMBER}|输入选择;类型;付
    勾选列表数据(new)    1
    点击列表按钮    对账单
    离开框架
    等待loading消失
    切换窗口    new
    ${checkaccountno}    获取页面文本内容    xpath=//label[@title='对账单号']/../..//div[@class='ant-form-item-control ']/span
    关闭当前窗口
    切换窗口    main
    进入菜单页面(第三版)    结算    对账单管理
    进入主页面框架
    对账单管理页面查询    ${checkaccountno}
    勾选列表记录    1
    点击列表按钮    请 款
    离开框架
    ${applyNo}    生成请款单
    关闭当前窗口
    #检查请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    我的请款单
    进入主页面框架
    我的请款单--未付款页面查询    ${applyNo}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

生成请款单(发票列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    基石列表查询【第二版】    输入选择;各类编号;${WORKNUMBER}
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    ${新增金额}    新增收入费用    ${往来单位}    ${发票抬头}
    新增支出费用    ${往来单位}    ${发票抬头}
    #登记应付发票
    勾选详情应付列表最后一条
    点击指定列表按钮    应付    发票登记
    切换窗口
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #查询发票
    切换窗口    main
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    勾选全部    new
    点击列表按钮    请 款
    离开框架
    ${applyNo}    生成请款单
    关闭当前窗口
    #检查请款单
    切换窗口    main
    进入菜单页面(第三版)    结算    我的请款单
    进入主页面框架
    我的请款单--未付款页面查询    ${applyNo}
    ${实际值}    获取页面数据条数
    离开框架
    #验证
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

请款审核

请款并登记发票

请款单添加费用

部分受理的请款单剔除费用

请款单受理生成待付款单

审核待付款单

取消审核待付款单

删除待付款单

取消请款单

待付款单分公司代付

生成付款单(付款)

删除付款单(付款)

生成付款单(预付)

删除付款单(预付)

付款核销(发票列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #登记应付发票
    回到首页
    进入菜单页面(第三版)    结算    应付待登记
    进入主页面框架
    登记发票--按工作单页面查询    ${WORKNUMBER}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #生成请款单
    回到首页
    进入菜单页面(第三版)    结算    应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    勾选全部
    点击列表按钮    请 款
    离开框架
    ${applyNo}    生成请款单    公账
    关闭当前窗口
    #填付款依据
    切换窗口    main
    进入菜单页面(第三版)    结算    请款单管理
    #生成待付款单
    进入主页面框架
    请款单管理--不可受理页面查询    ${applyNo}
    勾选全部
    点击列表按钮    受理&生成待付款单
    生成待付款单
    离开框架
    #生成付款单并核销
    点击付款单管理
    进入主页面框架
    付款单管理--待付款未审核页面查询    ${applyNo}
    ${待付款单号}    获取页面文本内容    xpath=//a[contains(@href,'/fmsfinance-front/#/paymentDetail?id=')]
    勾选全部
    待付款单审核
    点击待付款待核销
    付款单管理--待付款待核销页面查询    ${待付款单号}
    点击    xpath=//a[contains(@href,'/fmsfinance-front/#/paymentDetail?id=')]    #点击超链接
    离开框架
    ${paybillno}    待付款单生成付款单并核销
    #验证核销成功
    切换窗口    main
    点击核销记录(付款)
    进入主页面框架
    核销记录(付款)页面查询    核销编号    ${paybillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

付款核销(合并核销)

付款核销(多对象核销)

付款核销(只有收入)

付款核销(只有支出)

付款核销(收入支出-非零)

付款快速核销(费用列表-按费用)
    #维护收入费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    整票确认
    关闭当前窗口
    #生成收款单
    切换窗口    main
    进入菜单页面(第三版)    结算    费用列表
    进入主页面框架
    费用列表--按费用页面高级查询(单列)    工作单号    ${WORKNUMBER}
    费用列表--按费用页面高级查询(单列)    类型    付
    点击    xpath=//tbody[@class='ant-table-tbody']/tr[1]//input    #勾选列表第一条数据
    点击列表按钮    快速核销
    ${recbillno}    进入快速核销页面核销    paybillno
    离开框架
    进入菜单页面(第三版)    结算    付款单管理
    点击核销记录(付款)
    进入主页面框架
    核销记录(付款)页面查询    核销编号    ${recbillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

付款快速核销(账单列表)

付款快速核销(对账单列表)

付款快速核销(发票列表)
    #维护费用
    进入菜单页面(第三版)    订单    订单列表
    订单列表高级查询(双列)    各类编号    ${WORKNUMBER}    精确
    点击业务编号进入详情页    ${WORKNUMBER}
    切换窗口    new
    点击费用
    新增支出费用    ${往来单位}    ${发票抬头}
    关闭当前窗口
    #登记应付发票
    回到首页
    进入菜单页面(第三版)    结算    应付待登记
    进入主页面框架
    登记发票--按工作单页面查询    ${WORKNUMBER}
    勾选全部
    点击列表按钮    自定义开票
    离开框架
    切换窗口    new
    勾选全部
    点击列表按钮    登记发票号
    ${time}    get time    epoch
    ${应付invoice}    生成应付登记发票    ${time}
    关闭当前窗口
    #生成请款单
    回到首页
    进入菜单页面(第三版)    结算    应付发票管理
    点击应付发票管理
    进入主页面框架
    应付发票管理页面查询    ${应付invoice}
    勾选全部
    点击列表按钮    快速核销
    ${paybillno}    进入快速核销页面核销    paybillno
    离开框架
    进入菜单页面(第三版)    结算    付款单管理
    点击核销记录(付款)
    进入主页面框架
    核销记录(付款)页面查询    核销编号    ${paybillno}
    ${实际值}    获取页面数据条数
    离开框架
    ${预期值}    Evaluate    str(1)
    应该要相等    ${实际值}    ${预期值}

付款快速核销(只有收入)

付款快速核销(只有支出)

付款快速核销(收入支出-非零)

付款快速核销(收入支出-零)

付款退款

撤销付款退款

复核付款核销记录

取消复核付款核销记录
