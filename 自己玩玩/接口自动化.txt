*** Settings ***
Library           OlymLibrary
Library           requests
Library           Collections
Library           ExcelLibrary

*** Test Cases ***
百度
    Create Session    baidu    http://www.baidu.com
    ${headers}    Create Dictionary    Content-type=application/json;charset=utf-8
    ${params}    Create Dictionary    wd=123
    ${resquest}    get Request    baidu    /s    params=${params}    headers=${headers}
    ${r}    Set Variable    ${resquest.json}
    ${code}    Get From Dictionary    ${r}    code
    ${msg}    Get From Dictionary    ${r}    message

读取
    Open Excel Document    ${CURDIR}\\读取.xlsx    user    #读取列表
    ${list}    Create List    \    #创建list
    ${row-count}    get excel row    sheet1    #获取最大行
    ${column-count}    Get Excel Column    sheet1    #获得列数
    log    ${row-count}    #输入最大行数
    : FOR    ${i}    IN    ${column-count}    #循环获取行内数据
    \    ${count}    Read Excel Row    row_num=${i}    max_num=${row-count}    sheet_name=sheet1
    \    ${www}    Set Variable    ${count[0]}    #获取行第一个内元素
    \    ${url}    Set Variable    ${count[1]}    #获取行第二个内元素
    \    ${params}    Set Variable    ${count[2]}    #获取行第三个内元素
    \    ${data}    Set Variable    ${www}    ${url}    ${params}    #封装
    \    log    ${data}    #输入data
    \    Append To List    ${data}    #添加到list
    Close Current Excel Document    #关闭excel
    : FOR    ${api}    IN    ${list}    #从list中获取数据
    Create Session    baidu    ${api[0]}    #创建会话
    ${headers}    Create Dictionary    Content-type=application/json;charset=utf-8
    ${params}    Create Dictionary    ${api[2]}
    ${resquest}    get Request    ${api[0]}    ${api[1]}    ${api[2]}    headers=${headers}    #接口传值
    ${r}    Set Variable    ${resquest.json}    #转换格式
    ${code}    Get From Dictionary    ${r}    code
    ${msg}    Get From Dictionary    ${r}    message
    Should Be Equal As Strings    ${code}    200
